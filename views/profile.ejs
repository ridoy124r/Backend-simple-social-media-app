<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 25%, #4c1d95 50%, #6b21a8 75%, #7c3aed 100%);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
    }

    .scene-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 0;
      pointer-events: none;
    }

    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 3s infinite ease-in-out;
    }

    .star-1 {
      top: 10%;
      left: 15%;
      width: 2px;
      height: 2px;
      animation-delay: 0s;
    }

    .star-2 {
      top: 20%;
      right: 20%;
      width: 3px;
      height: 3px;
      animation-delay: 1s;
    }

    .star-3 {
      top: 15%;
      right: 10%;
      width: 2px;
      height: 2px;
      animation-delay: 2s;
    }

    .star-4 {
      top: 30%;
      left: 25%;
      width: 2px;
      height: 2px;
      animation-delay: 1.5s;
    }

    .star-5 {
      top: 25%;
      left: 55%;
      width: 3px;
      height: 3px;
      animation-delay: 0.5s;
    }

    .star-6 {
      top: 35%;
      right: 35%;
      width: 2px;
      height: 2px;
      animation-delay: 0.8s;
    }

    @keyframes twinkle {

      0%,
      100% {
        opacity: 0.3;
        transform: scale(1);
      }

      50% {
        opacity: 1;
        transform: scale(1.2);
      }
    }

    .cloud {
      position: absolute;
      background: rgba(139, 92, 246, 0.15);
      border-radius: 100px;
      animation: float 25s infinite ease-in-out;
    }

    .cloud-1 {
      top: 8%;
      left: 5%;
      width: 130px;
      height: 45px;
      animation-delay: 0s;
    }

    .cloud-2 {
      top: 20%;
      right: 10%;
      width: 110px;
      height: 38px;
      animation-delay: 8s;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-25px);
      }
    }

    .glass-card {
      backdrop-filter: blur(20px);
      background: rgba(167, 139, 250, 0.12);
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    .textarea-field {
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
      resize: vertical;
      min-height: 120px;
    }

    .textarea-field:focus {
      background: rgba(255, 255, 255, 0.12);
      border-color: rgba(255, 255, 255, 0.5);
      outline: none;
    }

    .post-btn {
      background: linear-gradient(135deg, #a78bfa 0%, #c4b5fd 100%);
      transition: all 0.3s ease;
    }

    .post-btn:hover {
      background: linear-gradient(135deg, #c4b5fd 0%, #ddd6fe 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(167, 139, 250, 0.4);
    }

    .like-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }

    .like-btn:hover {
      background: rgba(239, 68, 68, 0.2);
      border-color: rgba(239, 68, 68, 0.5);
      transform: scale(1.05);
    }

    .logout-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }

    .logout-btn:hover {
      background: rgba(239, 68, 68, 0.15);
      border-color: rgba(239, 68, 68, 0.4);
    }

    .edit-link {
      background: rgba(59, 130, 246, 0.15);
      border: 1px solid rgba(59, 130, 246, 0.3);
      transition: all 0.3s ease;
    }

    .edit-link:hover {
      background: rgba(59, 130, 246, 0.25);
      border-color: rgba(59, 130, 246, 0.5);
    }

    .delete-link {
      background: rgba(239, 68, 68, 0.15);
      border: 1px solid rgba(239, 68, 68, 0.3);
      transition: all 0.3s ease;
    }

    .delete-link:hover {
      background: rgba(239, 68, 68, 0.25);
      border-color: rgba(239, 68, 68, 0.5);
    }
  </style>
</head>

<body class="p-4 pb-20">

  <!-- 3D Scene Background -->
  <div class="scene-container">
    <div class="star star-1"></div>
    <div class="star star-2"></div>
    <div class="star star-3"></div>
    <div class="star star-4"></div>
    <div class="star star-5"></div>
    <div class="star star-6"></div>
    <div class="cloud cloud-1"></div>
    <div class="cloud cloud-2"></div>
  </div>

  <!-- Main Container -->
  <div class="max-w-4xl mx-auto relative z-10">

    <!-- Header -->
    <div class="glass-card rounded-3xl p-6 mb-6">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div
            class="w-16 h-16 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white text-2xl font-bold">
            <%= user.email.charAt(0).toUpperCase() %>
          </div>
          <div>
            <h1 class="text-2xl font-bold text-white">
              <%= user.email %>
            </h1>
            <p class="text-purple-200 text-sm">Your Profile</p>
          </div>
        </div>
        <a href="/logout" class="logout-btn px-6 py-2 rounded-full text-white font-semibold flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
          </svg>
          Logout
        </a>
      </div>
    </div>

    <!-- Create Post Card -->
    <div class="glass-card rounded-3xl p-6 mb-6">
      <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
        <svg class="w-6 h-6 text-purple-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        Create New Post
      </h2>
      <form method="POST" action="/posts/create-post" class="space-y-4">
        <textarea name="content" required maxlength="2000"
          class="textarea-field w-full px-4 py-3 text-white placeholder-gray-400 rounded-xl"
          placeholder="What's on your mind?"></textarea>
        <div class="flex justify-between items-center">
          <span class="text-purple-200 text-sm">Share your thoughts with the world</span>

          <button type="submit"
            class="post-btn px-8 py-3 rounded-full text-purple-950 font-bold flex items-center gap-2 hover:bg-purple-100 transition">
            <svg class="w-5 h-5 transform -rotate-45" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
            </svg>
            Post
          </button>

        </div>
      </form>
    </div>

    <!-- Posts Feed -->
    <div class="space-y-4">
      <h2 class="text-2xl font-bold text-white mb-4 flex items-center gap-2">
        <svg class="w-6 h-6 text-purple-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z">
          </path>
        </svg>
        Posts
      </h2>

      <% if (posts.length===0) { %>
        <div class="glass-card rounded-2xl p-12 text-center">
          <svg class="w-16 h-16 mx-auto text-purple-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
            </path>
          </svg>
          <p class="text-white text-lg font-semibold mb-2">No posts yet</p>
          <p class="text-purple-200">Create your first post to get started!</p>
        </div>
        <% } else { %>
          <% posts.forEach(post=> { %>
            <div class="glass-card rounded-2xl p-6">
              <div class="flex items-start gap-4">
                <div
                  class="w-12 h-12 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white text-lg font-bold flex-shrink-0">
                  <%= user.email.charAt(0).toUpperCase() %>
                </div>
                <div class="flex-1">
                  <div class="flex items-center justify-between mb-3">
                    <h3 class="text-white font-semibold">
                      <%= user.email %>
                    </h3>
                  </div>
                  <p class="text-purple-100 mb-4 leading-relaxed">
                    <%= post.content %>
                  </p>

                  <div class="flex items-center gap-3 flex-wrap">
                    <!-- Like Button -->
                    <form method="POST" action="/posts/like/<%= post.id %>" class="inline-block">
                      <button type="submit"
                        class="like-btn px-4 py-2 rounded-full text-white font-semibold flex items-center gap-2 text-sm">
                        <svg class="w-5 h-5"
                          fill="<%= post.likes?.some(like => like.userId === user.id) ? 'currentColor' : 'none' %>"
                          stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                          </path>
                        </svg>
                        <%= post.likes?.length || 0 %>
                      </button>
                    </form>

                    <% if (post.userId===user.id) { %>
                      <!-- Edit Link -->
                      <a href="/posts/edit/<%= post.id %>"
                        class="edit-link px-4 py-2 rounded-full text-white font-semibold flex items-center gap-2 text-sm">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
                          </path>
                        </svg>
                        Edit
                      </a>

                      <!-- Delete Link -->
                      <a href="/posts/delete/<%= post.id %>"
                        class="delete-link px-4 py-2 rounded-full text-white font-semibold flex items-center gap-2 text-sm">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                          </path>
                        </svg>
                        Delete
                      </a>
                      <% } %>
                  </div>
                </div>
              </div>
            </div>
            <% }) %>
              <% } %>
    </div>
  </div>

</body>

</html>